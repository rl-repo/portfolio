<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <![endif]-->
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SQL</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="stylesheet" href="style.css">
    <link href="css/prism.css" rel="stylesheet"/>
 
</head>

<body>
    <div class="header" id="myHeader">
        <div class="left-header">
            <h2>RL Portfolio</h2>
        </div>
        <div class="ulnav">
            <ul>
                <li>
                    <form action="index.html">
                        <button type="submit">
                            Home
                        </button>
                    </form>
                </li>
            </ul>
        </div>
    </div>

    <div class="body">
        <div class="tempSection" id="projs">
            <p class="container-title-test">SQL Samples</p>
            
            <hr>
            
            <div class="section-body" id="projects">
                <div class="proj">
                    <div class="img-wrap">
                        <a class="thumb-wrap" href="https://dbdiagram.io/d">
                            <img class="thumb" src="img/ig-db.png"></img>
                        </a>
                        <a href src="https://dbdiagram.io/d" class="fig-cap">dbdiagram.io</a>
                    </div>
                    
                    <div class="proj-text">
                        <div class="title-wrap">
                            <p class="title">Simple Instagram Clone Database Queries</p>
                            <a href="ig-clone.sql" download>
                                <i class="fa-solid fa-file-code"></i>
                            </a>
                        </div>

                        <p class="sub">
                            The database pictured above is a very primitive example of 
                            what an Instagram clone could potentially be. Showing basic 
                            data points to showchase queries and table relationships. 
                            Created and obtained from a Udemy course.
                        </p>
                        
                        <ul>
                                <li>Getting five oldest users.
                                    <pre><code class="language-sql">SELECT 
    username, 
    created_at,
    CONCAT(TIMESTAMPDIFF(DAY, created_at, NOW()), ' days old') AS age
FROM users
ORDER BY created_at
LIMIT 5;</code></pre> 
<table>
    <md-block>
        | username         | created_at          | age           |
        |------------------|---------------------|---------------|
        | Darby_Herzog     | 2016-05-06 00:14:21 | 2492 days old |
        | Emilio_Bernier52 | 2016-05-06 13:04:30 | 2492 days old |
        | Elenor88         | 2016-05-08 01:30:41 | 2490 days old |
        | Nicole71         | 2016-05-09 17:30:22 | 2488 days old |
        | Jordyn.Jacobson2 | 2016-05-14 07:56:26 | 2484 days old |
    </md-block>
    <!-- 
    <table id="sql-tab">
        <thead>
        <tr>
            <th>username</th>
            <th>created_at</th>
            <th>age</th>
            <th>Header 4</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>apu</td>
            <td>apu</td>
            <td>apu</td>
            <td>apu</td>
        </tr>

        </tbody>
    </table>
    -->
    
            
                                </li>
                                <br>
                                                             
                                <li>Determining which day of the week is most popular.
                                    Can also extract day of week in name with DAYNAME(created_at) instead.
                                    <pre><code class="language-sql">SELECT 
    DATE_FORMAT(DATE(created_at), '%W') AS day_of_week,
    COUNT(*) AS total
FROM users
GROUP BY DATE_FORMAT(DATE(created_at), '%W')
ORDER BY total DESC; 
</code></pre> 
    <md-block>
| day_of_week | total |
|-------------|-------|
| Thursday    |    16 |
| Sunday      |    16 |
| Friday      |    15 |
| Tuesday     |    14 |
| Monday      |    14 |
| Wednesday   |    13 |
| Saturday    |    12 |
    </md-block>
                                </li>
                                <br>

                                <li>Find inactive users, defined by zero pictures posted.
                                    Alternatively, query where photo.id is null.
                                    <pre><code class="language-sql">SELECT 
    username,
    image_url 
FROM users
LEFT JOIN photos 
    ON users.id = photos.user_id
WHERE image_url IS NULL;
</code></pre> 
    <md-block>

        | username            | image_url |
        |---------------------|-----------|
        | Aniya_Hackett       | NULL      |
        | Bartholome.Bernhard | NULL      |
        | Bethany20           | NULL      |
        | Darby_Herzog        | NULL      |
        | David.Osinski47     | NULL      |
        | Duane60             | NULL      |
        | Esmeralda.Mraz57    | NULL      |
        | Esther.Zulauf61     | NULL      |
        | Franco_Keebler64    | NULL      |
        | Hulda.Macejkovic    | NULL      |
        | Jaclyn81            | NULL      |
        | Janelle.Nikolaus81  | NULL      |
        | Jessyca_West        | NULL      |
        | Julien_Schmidt      | NULL      |
        | Kasandra_Homenick   | NULL      |
        | Leslie67            | NULL      |
        | Linnea59            | NULL      |
        | Maxwell.Halvorson   | NULL      |
        | Mckenna17           | NULL      |
        | Mike.Auer39         | NULL      |
        | Morgan.Kassulke     | NULL      |
        | Nia_Haag            | NULL      |
        | Ollie_Ledner37      | NULL      |
        | Pearl7              | NULL      |
        | Rocio33             | NULL      |
        | Tierra.Trantow      | NULL      |
    </md-block>

<br>
                                </li>
                                <br>

                                <li>Pictures/posts with the most likes.
                                    <pre><code class="language-sql">SELECT
    image_url,
    u.username,
    COUNT(*) AS total_likes
FROM photos
JOIN users u 
    ON u.id = photos.user_id
JOIN likes 
    ON likes.photo_id = photos.id
GROUP BY photos.id
ORDER BY total_likes DESC
LIMIT 5; 
 </code></pre> 
    <md-block>
        | image_url              | username        | total_likes |
        |------------------------|-----------------|-------------|
        | jarret.name    | Zack_Kemmer93   |          48 |
        | celestine.name | Malinda_Streich |          43 |
        | dorcas.biz     | Adelle96        |          43 |
        | shannon.org     | Seth46          |          42 |
        | dejon.name     | Delpha.Kihn     |          41 |
    </md-block>
                                </li>
                                <br>

                                <li>How many times does an aveage user post? There were multiple ways to approach this e.g. 
                                    is considered an 'inactive' user -- 0 posts? 0 likes? In this instance, simplicity is 
                                    best. Thus, the query takes into account for all users and all posts.
                                    <pre><code class="language-sql">SELECT (SELECT COUNT(*) FROM photos) / (SELECT COUNT(*) FROM users) AS avg_post;
</code></pre> 
    <md-block>
        | avg_post |
        |----------|
        |   2.5700 |
    </md-block>
                                </li>
                                <br>

                                <li>Find the top five most common hashtags. 
                                    An example application of this information is to use these tags in
                                     order to increase the chances of your picture to trend through 
                                     the explore page. However, this data did include ties so the <i>top 5</i> 
                                     can be extended to top 8.
                                    <pre><code class="language-sql">SELECT
    tags.tag_name,
    COUNT(*) AS tag_count
FROM photo_tags
JOIN tags 
    ON photo_tags.tag_id = tags.id
GROUP BY tags.id
ORDER BY tag_count DESC
LIMIT 5;</code></pre>
<md-block>
    | tag_name | tag_count |
    |----------|-----------|
    | smile    |        59 |
    | beach    |        42 |
    | party    |        39 |
    | fun      |        38 |
| concert  |        24 |
</md-block>
                                </li>                
                                <br>

                                <li>Since social media is riddled with bots, 
                                    this query finds which users are bots that likes all user posts. 
                                    There are two approaches shown below.
<pre><code class="language-sql">SELECT * 
FROM (
    SELECT 
        user_id,
        username,
        CASE
            WHEN COUNT(*) = (SELECT COUNT(*) FROM photos) THEN 1
            ELSE 0
        END as bot_status
        FROM likes
        JOIN users ON users.id = likes.user_id
        GROUP BY user_id) AS temp
WHERE temp.bot_status = 1;</code></pre> 
<md-block>
| user_id | username           | bot_status |
|---------|--------------------|------------|
|       5 | Aniya_Hackett      |          1 |
|      91 | Bethany20          |          1 |
|      54 | Duane60            |          1 |
|      14 | Jaclyn81           |          1 |
|      76 | Janelle.Nikolaus81 |          1 |
|      57 | Julien_Schmidt     |          1 |
|      75 | Leslie67           |          1 |
|      24 | Maxwell.Halvorson  |          1 |
|      41 | Mckenna17          |          1 |
|      66 | Mike.Auer39        |          1 |
|      71 | Nia_Haag           |          1 |
|      36 | Ollie_Ledner37     |          1 |
|      21 | Rocio33            |          1 |
</md-block>
 <pre><code class="language-sql">SELECT
	username, 
	COUNT(*) AS num_likes 
FROM users 
INNER JOIN likes 
	ON users.id = likes.user_id 
GROUP BY likes.user_id 
HAVING num_likes = (SELECT Count(*) FROM photos); </code></pre>
    <md-block>
| username           | num_likes |
|--------------------|-----------|
| Aniya_Hackett      |       257 |
| Bethany20          |       257 |
| Duane60            |       257 |
| Jaclyn81           |       257 |
| Janelle.Nikolaus81 |       257 |
| Julien_Schmidt     |       257 |
| Leslie67           |       257 |
| Maxwell.Halvorson  |       257 |
| Mckenna17          |       257 |
| Mike.Auer39        |       257 |
| Nia_Haag           |       257 |
| Ollie_Ledner37     |       257 |
| Rocio33            |       257 |

    </md-block>
                                </li>
                                <br>

                                <!-- Template 
                                <li>[Query]
                                    <pre><code class="language-sql">SELECT 
 </code></pre> 
    <md-block>

    </md-block>
                                </li>
                                <br>
                                -->


                        </ul>
                          
                    </div>
                </div>
            </div>
        </div>
    </div>


   
        
    <script src="script.js" async defer></script>
    <script src="js/prism.js"></script>
    <script type="module" src="https://md-block.verou.me/md-block.js"></script>
    <script src="https://kit.fontawesome.com/d22460e4b2.js" crossorigin="anonymous"></script>

    
</body>

</html>